<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>बीज - छत्तीसगढ़ राज्य बीज वितरण एवं गुण नियंत्रण मॉड्यूल</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
    
    <!-- Google Fonts - Poppins and Noto Sans Devanagari -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Noto+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Three.js for 3D effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- PDF.js for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        :root {
            --primary-color: #0a4275; /* Dark Blue */
            --secondary-color: #1e88e5; /* Light Blue */
            --accent-color: #64b5f6; /* Lighter Blue */
            --light-color: #f5f9ff;
            --dark-color: #002447;
            --text-color: #333;
            --white-color: #ffffff;
        }
        
        body {
            font-family: 'Poppins', 'Noto Sans Devanagari', sans-serif;
            background-color: var(--light-color);
            color: var(--text-color);
            min-height: 100vh;
        }
        
        .hindi-text {
            font-family: 'Noto Sans Devanagari', sans-serif;
            font-weight: 500;
        }
        
        .bold-text {
            font-weight: 700;
        }
        
        .auth-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .auth-card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 36, 71, 0.1);
            overflow: hidden;
            background: var(--white-color);
        }
        
        .auth-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 2rem;
            text-align: center;
            color: var(--white-color);
        }
        
        .auth-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .auth-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }
        
        .auth-tabs .nav-link {
            color: var(--text-color);
            font-weight: 600;
            padding: 1rem;
            border: none;
        }
        
        .auth-tabs .nav-link.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background-color: transparent;
        }
        
        .form-label {
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .form-control {
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.25rem rgba(30, 136, 229, 0.25);
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            padding: 0.75rem 1.5rem;
            font-weight: 600;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover, .btn-primary:focus {
            background-color: var(--dark-color);
            border-color: var(--dark-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 36, 71, 0.2);
        }
        
        .card-3d {
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.5s ease;
            transform-style: preserve-3d;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--white-color);
            position: relative;
            height: 120px;
        }
        
        .card-3d:hover {
            transform: translateY(-10px) rotateX(5deg) rotateY(5deg);
            box-shadow: 0 15px 30px rgba(0, 36, 71, 0.3);
        }
        
        .card-3d-content {
            padding: 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .card-3d-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .card-3d-text {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        #canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        .footer {
            background-color: var(--primary-color);
            color: var(--white-color);
            padding: 1rem 0;
            text-align: center;
        }
        
        .password-strength {
            margin-top: 0.5rem;
            font-size: 0.85rem;
        }
        
        .success-checkmark {
            font-size: 5rem;
            color: #4CAF50;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="auth-container d-flex align-items-center justify-content-center min-vh-100">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-lg-10">
                    <div class="auth-card card">
                        <div class="auth-header">
                            <h1 class="auth-title hindi-text bold-text">बीज (Beej)</h1>
                            <p class="auth-subtitle hindi-text">छत्तीसगढ़ राज्य बीज वितरण एवं गुण नियंत्रण मॉड्यूल</p>
                            <p class="hindi-text mb-0">कृषि विभाग, छत्तीसगढ़ शासन</p>
                        </div>
                        
                        <div class="card-body p-4">
                            <!-- Auth Tabs -->
                            <ul class="nav nav-tabs auth-tabs mb-4" id="authTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link hindi-text" id="login-tab" data-bs-toggle="tab" data-bs-target="#login-pane" type="button" role="tab" aria-controls="login-pane" aria-selected="false">लॉगिन</button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active hindi-text" id="register-tab" data-bs-toggle="tab" data-bs-target="#register-pane" type="button" role="tab" aria-controls="register-pane" aria-selected="true">पंजीकरण</button>
                                </li>
                            </ul>
                            
                            <!-- Tab Content -->
                            <div class="tab-content" id="authTabsContent">
                                <!-- Login Form -->
                                <div class="tab-pane fade" id="login-pane" role="tabpanel" aria-labelledby="login-tab" tabindex="0">
                                    <div class="row mb-4">
                                        <div class="col-md-4 mb-3">
                                            <div class="card-3d">
                                                <div id="canvas-container-1" class="canvas-3d"></div>
                                                <div class="card-3d-content">
                                                    <h3 class="card-3d-title hindi-text">सुरक्षित लॉगिन</h3>
                                                    <p class="card-3d-text hindi-text">उपयोगकर्ता प्रमाणीकरण</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <div class="card-3d">
                                                <div id="canvas-container-2" class="canvas-3d"></div>
                                                <div class="card-3d-content">
                                                    <h3 class="card-3d-title hindi-text">डैशबोर्ड एक्सेस</h3>
                                                    <p class="card-3d-text hindi-text">अपने कार्यों का प्रबंधन करें</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4 mb-3">
                                            <div class="card-3d">
                                                <div id="canvas-container-3" class="canvas-3d"></div>
                                                <div class="card-3d-content">
                                                    <h3 class="card-3d-title hindi-text">रिपोर्ट देखें</h3>
                                                    <p class="card-3d-text hindi-text">विस्तृत विश्लेषण</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <form id="loginForm">
                                        <div class="mb-3">
                                            <label for="loginUsername" class="form-label hindi-text">उपयोगकर्ता नाम</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-person-fill"></i></span>
                                                <input type="text" class="form-control" id="loginUsername" placeholder="अपना उपयोगकर्ता नाम दर्ज करें" required>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-3">
                                            <label for="loginPassword" class="form-label hindi-text">पासवर्ड</label>
                                            <div class="input-group">
                                                <span class="input-group-text"><i class="bi bi-lock-fill"></i></span>
                                                <input type="password" class="form-control" id="loginPassword" placeholder="अपना पासवर्ड दर्ज करें" required>
                                                <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-4 form-check">
                                            <input type="checkbox" class="form-check-input" id="rememberMe">
                                            <label class="form-check-label hindi-text" for="rememberMe">मुझे याद रखें</label>
                                            <a href="#" class="float-end hindi-text">पासवर्ड भूल गए?</a>
                                        </div>
                                        
                                        <div class="d-grid gap-2">
                                            <button type="submit" class="btn btn-primary btn-lg hindi-text">लॉगिन करें</button>
                                        </div>
                                    </form>
                                </div>
                                
                                <!-- Register Form -->
                                <div class="tab-pane fade show active" id="register-pane" role="tabpanel" aria-labelledby="register-tab" tabindex="0">
                                    <div id="registrationForm">
                                        <form id="userRegistrationForm">
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label for="fullName" class="form-label hindi-text">पूरा नाम</label>
                                                    <input type="text" class="form-control" id="fullName" placeholder="अपना पूरा नाम दर्ज करें" required>
                                                </div>
                                                <div class="col-md-6">
                                                    <label for="mobileNumber" class="form-label hindi-text">मोबाइल नंबर</label>
                                                    <input type="tel" class="form-control" id="mobileNumber" placeholder="10 अंकों का मोबाइल नंबर दर्ज करें" pattern="[0-9]{10}" required>
                                                </div>
                                            </div>
                                            
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label for="userType" class="form-label hindi-text">उपयोगकर्ता प्रकार</label>
                                                    <select class="form-select" id="userType" required>
                                                        <option value="" selected disabled>उपयोगकर्ता प्रकार चुनें</option>
                                                        <option value="state">राज्य उपयोगकर्ता</option>
                                                        <option value="lab">बीज गुण नियंत्रण प्रयोगशाला</option>
                                                        <option value="division">मंडल उपयोगकर्ता</option>
                                                        <option value="district">जिला उपयोगकर्ता</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <label for="userRole" class="form-label hindi-text">उपयोगकर्ता भूमिका</label>
                                                    <select class="form-select" id="userRole" required disabled>
                                                        <option value="" selected disabled>पहले उपयोगकर्ता प्रकार चुनें</option>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label for="division" class="form-label hindi-text">मंडल</label>
                                                    <select class="form-select" id="division" disabled>
                                                        <option value="" selected disabled>मंडल चुनें</option>
                                                        <!-- Will be populated from database -->
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <label for="district" class="form-label hindi-text">जिला</label>
                                                    <select class="form-select" id="district" disabled>
                                                        <option value="" selected disabled>पहले मंडल चुनें</option>
                                                        <!-- Will be populated from database based on division -->
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            <div class="mb-4 form-check">
                                                <input type="checkbox" class="form-check-input" id="termsAgree" required>
                                                <label class="form-check-label hindi-text" for="termsAgree">
                                                    मैं <a href="#">नियम और शर्तों</a> से सहमत हूँ
                                                </label>
                                            </div>
                                            
                                            <div class="d-grid gap-2">
                                                <button type="submit" class="btn btn-primary btn-lg hindi-text">पंजीकरण करें</button>
                                            </div>
                                        </form>
                                    </div>
                                    
                                    <!-- Registration Success (initially hidden) -->
                                    <div id="registrationSuccess" style="display: none;" class="text-center py-5">
                                        <i class="bi bi-check-circle-fill success-checkmark mb-3"></i>
                                        <h3 class="hindi-text bold-text mb-3">पंजीकरण सफल!</h3>
                                        <p class="hindi-text mb-4">आपका पंजीकरण सफलतापूर्वक हो गया है। आपके क्रेडेंशियल्स के साथ पीडीएफ डाउनलोड हो रहा है।</p>
                                        <div class="d-grid gap-2 col-md-6 mx-auto">
                                            <button id="downloadCredentials" class="btn btn-primary hindi-text">
                                                <i class="bi bi-download me-2"></i> क्रेडेंशियल्स डाउनलोड करें
                                            </button>
                                            <button id="goToLogin" class="btn btn-outline-primary hindi-text">
                                                लॉगिन करें
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-3">
                        <p class="hindi-text text-muted">© 2023 कृषि विभाग, छत्तीसगढ़ शासन। सर्वाधिकार सुरक्षित।</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Supabase client
            const supabaseUrl = 'https://evgmvktquwufhdevtahx.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV2Z212a3RxdXd1ZmhkZXZ0YWh4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMyNjU0NTEsImV4cCI6MjA2ODg0MTQ1MX0.-JTBxxMms1U3H1nIzEQN54FEHKeHMP8HbUf7s3nIfIk';
            const supabase = supabase.createClient(supabaseUrl, supabaseKey);
            
            // Setup Three.js for 3D cards
            setupThreeJS();
            
            // Toggle password visibility
            document.getElementById('togglePassword').addEventListener('click', function() {
                const passwordInput = document.getElementById('loginPassword');
                const icon = this.querySelector('i');
                
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.classList.remove('bi-eye');
                    icon.classList.add('bi-eye-slash');
                } else {
                    passwordInput.type = 'password';
                    icon.classList.remove('bi-eye-slash');
                    icon.classList.add('bi-eye');
                }
            });
            
            // Load divisions from database
            async function loadDivisions() {
                try {
                    const { data, error } = await supabase
                        .from('divisions')
                        .select('id, division_name')
                        .order('division_name', { ascending: true });
                    
                    if (error) throw error;
                    
                    const divisionSelect = document.getElementById('division');
                    data.forEach(div => {
                        const option = document.createElement('option');
                        option.value = div.id;
                        option.textContent = div.division_name;
                        divisionSelect.appendChild(option);
                    });
                } catch (error) {
                    console.error('Error loading divisions:', error);
                    alert('मंडल लोड करने में त्रुटि');
                }
            }
            
            // Load districts based on selected division
            async function loadDistricts(divisionId) {
                try {
                    const districtSelect = document.getElementById('district');
                    districtSelect.innerHTML = '<option value="" selected disabled>जिला चुनें</option>';
                    
                    const { data, error } = await supabase
                        .from('districts')
                        .select('id, district_name')
                        .eq('division_id', divisionId)
                        .order('district_name', { ascending: true });
                    
                    if (error) throw error;
                    
                    data.forEach(dist => {
                        const option = document.createElement('option');
                        option.value = dist.id;
                        option.textContent = dist.district_name;
                        districtSelect.appendChild(option);
                    });
                    
                    districtSelect.disabled = false;
                } catch (error) {
                    console.error('Error loading districts:', error);
                    alert('जिले लोड करने में त्रुटि');
                }
            }
            
            // Load user roles from database
            async function loadUserRoles(userType) {
                try {
                    const roleSelect = document.getElementById('userRole');
                    roleSelect.innerHTML = '<option value="" selected disabled>भूमिका चुनें</option>';
                    
                    const { data, error } = await supabase
                        .from('user_dropdown')
                        .select('value, label')
                        .eq('role', userType)
                        .order('sort_order', { ascending: true });
                    
                    if (error) throw error;
                    
                    data.forEach(role => {
                        const option = document.createElement('option');
                        option.value = role.value;
                        option.textContent = role.label;
                        roleSelect.appendChild(option);
                    });
                    
                    roleSelect.disabled = false;
                } catch (error) {
                    console.error('Error loading user roles:', error);
                    alert('भूमिकाएं लोड करने में त्रुटि');
                }
            }
            
            // User type change event
            document.getElementById('userType').addEventListener('change', function() {
                const userType = this.value;
                const divisionSelect = document.getElementById('division');
                const districtSelect = document.getElementById('district');
                
                // Reset and disable location selects
                divisionSelect.disabled = true;
                districtSelect.disabled = true;
                
                // Load appropriate roles
                loadUserRoles(userType);
                
                // Enable division select for division and district users
                if (userType === 'division' || userType === 'district') {
                    divisionSelect.disabled = false;
                }
            });
            
            // Division change event
            document.getElementById('division').addEventListener('change', function() {
                const divisionId = this.value;
                const userType = document.getElementById('userType').value;
                
                if (userType === 'district' && divisionId) {
                    loadDistricts(divisionId);
                }
            });
            
            // Login form submission
            document.getElementById('loginForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                
                try {
                    // Query the users table for the provided username and password
                    const { data, error } = await supabase
                        .from('users')
                        .select('*')
                        .eq('username', username)
                        .eq('password', password)
                        .single();
                    
                    if (error) throw error;
                    
                    if (data) {
                        // Successful login
                        localStorage.setItem('user', JSON.stringify(data));
                        
                        // Redirect based on user role
                        window.location.href = 'dashboard.html';
                    } else {
                        alert('अमान्य उपयोगकर्ता नाम या पासवर्ड');
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    alert('लॉगिन में त्रुटि हुई');
                }
            });
            
            // Registration form submission
            document.getElementById('userRegistrationForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const fullName = document.getElementById('fullName').value;
                const mobileNumber = document.getElementById('mobileNumber').value;
                const userType = document.getElementById('userType').value;
                const userRole = document.getElementById('userRole').value;
                const divisionId = document.getElementById('division').value || null;
                const districtId = document.getElementById('district').value || null;
                
                try {
                    // Check if mobile number already exists
                    const { data: existingUser, error: checkError } = await supabase
                        .from('app_users')
                        .select('phone')
                        .eq('phone', mobileNumber)
                        .single();
                    
                    if (existingUser) {
                        alert('यह मोबाइल नंबर पहले से पंजीकृत है');
                        return;
                    }
                    
                    // Generate username (first part of name + last 4 digits of phone)
                    const namePart = fullName.split(' ')[0].toLowerCase();
                    const phonePart = mobileNumber.slice(-4);
                    const username = `${namePart}${phonePart}`;
                    
                    // Generate password (complex algorithm)
                    const password = generateSecurePassword();
                    
                    // Create user in users table
                    const { data: userData, error: userError } = await supabase
                        .from('users')
                        .insert([
                            {
                                username: username,
                                password: password,
                                full_name: fullName,
                                user_role: userRole,
                                district_id: districtId,
                                division_id: divisionId,
                                is_active: true
                            }
                        ])
                        .select();
                    
                    if (userError) throw userError;
                    
                    // Create user in app_users table
                    const { data: appUserData, error: appUserError } = await supabase
                        .from('app_users')
                        .insert([
                            {
                                username: username,
                                full_name: fullName,
                                phone: mobileNumber,
                                user_role: userRole,
                                district_id: districtId,
                                division_id: divisionId,
                                is_active: true
                            }
                        ])
                        .select();
                    
                    if (appUserError) throw appUserError;
                    
                    // Store credentials for PDF generation
                    const credentials = {
                        fullName: fullName,
                        username: username,
                        password: password,
                        userType: getUserTypeText(userType),
                        userRole: document.getElementById('userRole').options[document.getElementById('userRole').selectedIndex].text
                    };
                    
                    // Show success message and hide form
                    document.getElementById('registrationForm').style.display = 'none';
                    document.getElementById('registrationSuccess').style.display = 'block';
                    
                    // Generate and download PDF
                    generateCredentialsPDF(credentials);
                    
                } catch (error) {
                    console.error('Registration error:', error);
                    alert('पंजीकरण में त्रुटि हुई');
                }
            });
            
            // Download credentials button
            document.getElementById('downloadCredentials').addEventListener('click', function() {
                // This would regenerate the PDF if needed
                alert('क्रेडेंशियल्स डाउनलोड हो रहे हैं');
            });
            
            // Go to login button
            document.getElementById('goToLogin').addEventListener('click', function() {
                document.getElementById('login-tab').click();
            });
            
            // Helper function to get user type text
            function getUserTypeText(userType) {
                const types = {
                    'state': 'राज्य उपयोगकर्ता',
                    'lab': 'बीज गुण नियंत्रण प्रयोगशाला',
                    'division': 'मंडल उपयोगकर्ता',
                    'district': 'जिला उपयोगकर्ता'
                };
                return types[userType] || userType;
            }
            
// Generate secure password
function generateSecurePassword() {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';
    const length = 10;
    let password = '';
    
    // Ensure at least one uppercase, one lowercase, one number, one special char
    password += chars.substr(0, 26).charAt(Math.floor(Math.random() * 26)); // Uppercase
    password += chars.substr(26, 26).charAt(Math.floor(Math.random() * 26)); // Lowercase
    password += chars.substr(52, 10).charAt(Math.floor(Math.random() * 10)); // Number
    password += chars.substr(62).charAt(Math.floor(Math.random() * (chars.length - 62))); // Special
    
    // Fill the rest of the password
    for (let i = 4; i < length; i++) {
        password += chars.charAt(Math.floor(Math.random() * chars.length));
    }
    
    // Shuffle the password
    return password.split('').sort(() => 0.5 - Math.random()).join('');
}

// Generate PDF with credentials
function generateCredentialsPDF(credentials) {
    // Create a new jsPDF instance
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    
    // Add content to the PDF
    doc.setFont("helvetica", "bold");
    doc.setFontSize(20);
    doc.text("बीज पोर्टल उपयोगकर्ता क्रेडेंशियल्स", 105, 20, null, null, "center");
    
    doc.setFont("helvetica", "normal");
    doc.setFontSize(12);
    doc.text("छत्तीसगढ़ राज्य बीज वितरण एवं गुण नियंत्रण मॉड्यूल", 105, 30, null, null, "center");
    doc.text("कृषि विभाग, छत्तीसगढ़ शासन", 105, 40, null, null, "center");
    
    doc.line(20, 45, 190, 45);
    
    doc.setFont("helvetica", "bold");
    doc.setFontSize(14);
    doc.text("उपयोगकर्ता विवरण", 20, 60);
    
    doc.setFont("helvetica", "normal");
    doc.setFontSize(12);
    doc.text("पूरा नाम:", 20, 75);
    doc.text(credentials.fullName, 80, 75);
    
    doc.text("उपयोगकर्ता प्रकार:", 20, 85);
    doc.text(credentials.userType, 80, 85);
    
    doc.text("भूमिका:", 20, 95);
    doc.text(credentials.userRole, 80, 95);
    
    doc.setFont("helvetica", "bold");
    doc.text("लॉगिन क्रेडेंशियल्स", 20, 115);
    
    doc.setFont("helvetica", "normal");
    doc.text("उपयोगकर्ता नाम:", 20, 130);
    doc.setFont("courier", "bold");
    doc.text(credentials.username, 80, 130);
    
    doc.setFont("helvetica", "normal");
    doc.text("पासवर्ड:", 20, 140);
    doc.setFont("courier", "bold");
    doc.text(credentials.password, 80, 140);
    
    doc.setFont("helvetica", "italic");
    doc.setFontSize(10);
    doc.text("नोट: कृपया अपने क्रेडेंशियल्स सुरक्षित रखें और किसी के साथ साझा न करें।", 20, 160);
    doc.text("पहली बार लॉगिन करने के बाद अपना पासवर्ड बदलने की सलाह दी जाती है।", 20, 170);
    
    doc.setFont("helvetica", "normal");
    doc.setFontSize(10);
    doc.text("जारी करने की तिथि: " + new Date().toLocaleDateString(), 20, 190);
    doc.text("© कृषि विभाग, छत्तीसगढ़ शासन", 20, 200);
    
    // Save the PDF
    doc.save(`beej_credentials_${credentials.username}.pdf`);
}

// Setup Three.js for 3D cards
function setupThreeJS() {
    // Setup for each 3D card
    setupCard('canvas-container-1', 0x0a4275, 0x1e88e5);
    setupCard('canvas-container-2', 0x0a4275, 0x1e88e5);
    setupCard('canvas-container-3', 0x0a4275, 0x1e88e5);
}

function setupCard(containerId, color1, color2) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const width = container.clientWidth;
    const height = container.clientHeight;
    
    // Create scene, camera, and renderer
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
    
    renderer.setSize(width, height);
    container.appendChild(renderer.domElement);
    
    // Create particles
    const particlesGeometry = new THREE.BufferGeometry();
    const particlesCount = 100;
    
    const posArray = new Float32Array(particlesCount * 3);
    
    for (let i = 0; i < particlesCount * 3; i++) {
        posArray[i] = (Math.random() - 0.5) * 5;
    }
    
    particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
    
    // Material
    const particlesMaterial = new THREE.PointsMaterial({
        size: 0.05,
        color: 0xffffff,
        transparent: true,
        opacity: 0.8
    });
    
    // Mesh
    const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
    scene.add(particlesMesh);
    
    // Position camera
    camera.position.z = 3;
    
    // Animation
    const animate = () => {
        requestAnimationFrame(animate);
        
        particlesMesh.rotation.x += 0.001;
        particlesMesh.rotation.y += 0.001;
        
        renderer.render(scene, camera);
    };
    
    animate();
    
    // Handle window resize
    window.addEventListener('resize', () => {
        const newWidth = container.clientWidth;
        const newHeight = container.clientHeight;
        
        camera.aspect = newWidth / newHeight;
        camera.updateProjectionMatrix();
        
        renderer.setSize(newWidth, newHeight);
    });
}

// Initialize the page
loadDivisions();

